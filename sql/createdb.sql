create database shsp_db
DEFAULT CHARACTER SET utf8
DEFAULT COLLATE utf8_general_ci;

use shsp_db;

DROP TABLE IF EXISTS user_tbl;
CREATE TABLE user_tbl (
    ID INT NOT NULL AUTO_INCREMENT,
    NAME VARCHAR(64) NOT NULL,
    PWD VARCHAR(32) NOT NULL,
	EMAIL VARCHAR(64),
    FIRST_LOGIN INT NOT NULL,
	LAST_LOGIN_DATE DATETIME NOT NULL,
	STATE INT NOT NULL,
    PRIMARY KEY (ID)
)  ENGINE=INNODB;

DROP TABLE IF EXISTS role_tbl;
CREATE TABLE role_tbl (
    ID INT NOT NULL AUTO_INCREMENT,
    NAME VARCHAR(20) NOT NULL,
    DESCRIPTION VARCHAR(30),
    PRIMARY KEY (ID)
)  ENGINE=INNODB;

DROP TABLE IF EXISTS auth_tbl;
CREATE TABLE auth_tbl (
    ID INT NOT NULL AUTO_INCREMENT,
    NAME VARCHAR(30) NOT NULL,
    DESCRIPTION VARCHAR(30),
	PARAM VARCHAR(50) not null,
    PRIMARY KEY (ID)
)  ENGINE=INNODB;

DROP TABLE IF EXISTS group_tbl;
CREATE TABLE group_tbl (
    ID INT NOT NULL AUTO_INCREMENT,
    NAME VARCHAR(30) NOT NULL,
    DESCRIPTION VARCHAR(30),
    PRIMARY KEY (ID)
)  ENGINE=INNODB;

DROP TABLE IF EXISTS user_role_tbl;
CREATE TABLE user_role_tbl (
	ID INT NOT NULL AUTO_INCREMENT,
    ROLE_NAME VARCHAR(20) NOT NULL,
    USER_NAME VARCHAR(64) NOT NULL,
    PRIMARY KEY (ID)
)  ENGINE=INNODB;

DROP TABLE IF EXISTS role_auth_tbl;
CREATE TABLE role_auth_tbl (
    ID INT NOT NULL AUTO_INCREMENT,
    ROLE_NAME VARCHAR(20) NOT NULL,
    AUTH_NAME VARCHAR(30) NOT NULL,
    PRIMARY KEY (ID)
)  ENGINE=INNODB;

DROP TABLE IF EXISTS user_group_tbl;
CREATE TABLE user_group_tbl (
	ID INT NOT NULL AUTO_INCREMENT,
    USER_NAME VARCHAR(64) NOT NULL,	
    GROUP_NAME VARCHAR(20) NOT NULL,
    PRIMARY KEY (ID)
)  ENGINE=INNODB;

DROP TABLE IF EXISTS machine_type_tbl;
CREATE TABLE machine_type_tbl (
	ID INT NOT NULL AUTO_INCREMENT,
	NAME VARCHAR(16) NOT NULL,
	DESCRIPTION VARCHAR(100),
    PICTURE LONGBLOB,
	PRIMARY KEY (ID)
) ENGINE=INNODB;

DROP TABLE IF EXISTS lab_location_tbl;
CREATE TABLE lab_location_tbl(
	ID INT NOT NULL AUTO_INCREMENT,
    NAME VARCHAR(20) NOT NULL,
    DESCRIPTION VARCHAR(64),
    PRIMARY KEY(ID)
) ENGINE=INNODB;

DROP TABLE IF EXISTS machine_info_tbl;
CREATE TABLE machine_info_tbl (
    ID INT NOT NULL AUTO_INCREMENT,
    LABEL VARCHAR(20) NOT NULL,
    PN VARCHAR(10) NOT NULL,
    SN VARCHAR(10),
    SP_MAC VARCHAR(20) NOT NULL,
    SP_IP VARCHAR(16) NOT NULL,
    SP_TELNET_IP VARCHAR(16) NOT NULL,
    SP_TELNET_PORT VARCHAR(6) NOT NULL,
    STATE INT NOT NULL,
    POSITION VARCHAR(10),
    LOG VARCHAR(256),
    PRIMARY KEY (ID)
)  ENGINE=INNODB;

DROP TABLE IF EXISTS machine_type_tbl;
CREATE TABLE machine_type_tbl (
	ID INT NOT NULL AUTO_INCREMENT,
    MACHINE_LABEL VARCHAR(20) NOT NULL,
    TYPE_NAME VARCHAR(16) NOT NULL,
    PRIMARY KEY(ID)
) ENGINE = INNODB;

DROP TABLE IF EXISTS machine_group_tbl;
CREATE TABLE machine_group_tbl (
	ID INT NOT NULL AUTO_INCREMENT,
    MACHINE_LABEL VARCHAR(64) NOT NULL,
    GROUP_NAME VARCHAR(20) NOT NULL,    
    PRIMARY KEY (ID)
)  ENGINE=INNODB;

DROP TABLE IF EXISTS machine_location_tbl;
CREATE TABLE machine_location_tbl (
	ID INT NOT NULL AUTO_INCREMENT,
    MACHINE_LABEL VARCHAR(64) NOT NULL,
    LOCATION_NAME VARCHAR(20) NOT NULL,    
    PRIMARY KEY (ID)
)  ENGINE=INNODB;


DROP TABLE IF EXISTS res_tbl;
CREATE TABLE res_tbl (
    ID INT NOT NULL AUTO_INCREMENT,
	SYS_ID INT NOT NULL,
	USER_ID INT NOT NULL,
    RES_DATE DATETIME NOT NULL,
    RES_HOUR INT NOT NULL,
    PRIMARY KEY (ID)
)  ENGINE=INNODB;

DROP TABLE IF EXISTS access_record_tbl;
CREATE TABLE access_record_tbl (
	ID INT NOT NULL AUTO_INCREMENT,
    USER_NAME VARCHAR(50) NOT NULL,
    ACCESS_TYPE VARCHAR(30) NOT NULL,
    ACCESS_TIME DATETIME NOT NULL,
    ACCESS_IP VARCHAR(45) NOT NULL,
    PRIMARY KEY(ID)
) ENGINE=INNODB;

DROP TABLE IF EXISTS operation_record_tbl;
CREATE TABLE operation_record_tbl (
	ID INT NOT NULL AUTO_INCREMENT,
	USER_NAME VARCHAR(50) NOT NULL,
	OPERATION_NAME VARCHAR(30) NOT NULL,
	OPERATION_TIME DATETIME NOT NULL,
	OPERATION_RESULT VARCHAR(15) NOT NULL,
	PRIMARY KEY(ID)
) ENGINE=INNODB;


INSERT INTO `user_tbl` (
    NAME,PWD,EMAIL,FIRST_LOGIN,LAST_LOGIN_DATE,STATE
) VALUES 
    ('root', 'shsp', 'bin.wang@oracle.com', 1, '2017-12-04 00:00:00', 1),
	('binwan', 'abc123', 'bin.wang@oracle.com', 1, '2017-12-22 00:00:00', 1),
    ('dedong', 'abc123', 'debin.dong@oracle.com', 1, '2017-12-22 00:00:00', 1),
    ('gzeng', 'abc123', 'guojun.zeng@oracle.com', 1, '2017-12-22 00:00:00', 1),
    ('zhihx', 'abc123', 'zhihong.xie@oracle.com', 1, '2017-12-22 00:00:00', 1),
    ('liuyang', 'abc123', 'liu.l.yang@oracle.com', 1, '2017-12-22 00:00:00', 1);

INSERT INTO role_tbl (
	NAME, DESCRIPTION
) VALUES 
	('admin', 'system administrator'),
	('superUser', 'super user'),
    ('user', 'normal user');
    
INSERT INTO group_tbl (
	NAME, DESCRIPTION
) VALUES
	('ADMIN', 'Administrators'),
	('ILOM', 'ILOM Development Team'),
	('BIOS', 'BIOS development team'),
    ('FWQA', 'Firmware QA team'),
    ('OS', 'OS team');
    
INSERT INTO user_group_tbl (
	USER_NAME, GROUP_NAME
) VALUES 
	('binwan', 'ILOM'),
    ('dedong', 'ILOM'),
    ('gzeng', 'ILOM'),
    ('zhihx', 'ILOM'),
    ('liuyang', 'ILOM'),
	('root', 'ADMIN');   

INSERT INTO user_role_tbl (
	ROLE_NAME, USER_NAME
) VALUES 
	('superUser', 'binwan'),
    ('user', 'dedong'),
    ('user', 'gzeng'),
    ('user', 'zhihx'),
    ('user', 'liuyang'),
	('admin', 'root');